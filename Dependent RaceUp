library(foreign)
data<-read.dta("final1024.dta")
toadd<-data[,1:3]
toadd$downstreamdroneE<-data$downstreamdroneE
toadd$stateregu_constrain_focal<-data$stateregu_constrain_focal
toadd$stateregu_constrain_other_p1<-data$stateregu_constrain_other_p1
calmarket<-function(input,compare){
address<-which(compare[,1]!=as.numeric(as.matrix(input[1]))
&compare[,2]==as.numeric(as.matrix(input[2]))&
compare[,3]==as.numeric(as.matrix(input[3])))
all<-c(as.numeric(input[5])
,as.numeric(as.matrix(compare[address,5])))
add<-(input[5]-compare[address,6])
output<-(sum(add))
return(output)
}
library(plyr)
results<-apply(toadd,1,calmarket,toadd)
summary(results)
data$raceup<-results
