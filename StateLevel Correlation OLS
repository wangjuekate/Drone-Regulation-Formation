
library(foreign)

data<-read.dta(
"D:\\All_Projects\\Project_Me_Regulation\\Final Data Set\\FinalData_Regulation_09052017.dta")

fulldata<-read.dta(
"D:\\All_Projects\\Project_Me_Regulation\\Final Data Set\\Regulation0723.dta")

data<-data[order(data$statefipx,data$currentyear,data$month),]
toadd<-data[,1:3]
toadd$stateregu_promo_other<-data$stateregu_promo_other

pushprior<-function(input){
mm<-c(0,input[,4])
mm<-mm[1:nrow(input)]
mm<-paste(mm,collapse=",")
return(mm)
}

library(plyr)
results<-ddply(toadd,.(statefipx),pushprior)
add<-as.numeric(as.matrix(unlist(strsplit(results[,2],","))))
data$stateregu_promo_other_p1<-add

data<-merge(data,toadd,
by.x=c("currentyear","month","statefipx"),
by.y=c("currentyear","month","statefipx"),
all.x=TRUE)

summary(results)





data$smo<-data$nallsmo-data$nnationalsmo




results<-lm(stateregu_promo_focal~
allspot+ 
inst6014_nom +
cpo+
allprivacy+
 dem +
 gdppercap + 
 totalpop+
divided+as.character(statefipx)+as.character(currentyear)+
as.character(month), 
    data =data)
summary(results)



stateregu_constrain_other_p1+
stateregu_promo_other_p1+
nnationalsmo+
smo+
nclub+
alldrone_p+
nmarketdemand+
industryact+
privacyindex+
probindex+


results<-lm(stateregu_constrain_focal~
stateregu_constrain_other_p1+
stateregu_promo_other_p1+
nnationalsmo+
smo+
nclub+
alldrone_p+
nmarketdemand+
industryact+
privacyindex+
probindex+
allspot+ 
inst6014_nom +
cpo+
allprivacy+
 dem +
 gdppercap + 
 totalpop+
divided+as.character(statefipx)+as.character(currentyear)+
as.character(month), 
    data =data)
summary(results)
